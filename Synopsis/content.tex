\pdfbookmark{Общая характеристика работы}{characteristic}             % Закладка pdf
\section*{Общая характеристика работы}

\newcommand{\actuality}{\pdfbookmark[1]{Актуальность}{actuality}\underline{\textbf{\actualityTXT}}}
\newcommand{\progress}{\pdfbookmark[1]{Разработанность темы}{progress}\underline{\textbf{\progressTXT}}}
\newcommand{\aim}{\pdfbookmark[1]{Цели}{aim}\underline{{\textbf\aimTXT}}}
\newcommand{\tasks}{\pdfbookmark[1]{Задачи}{tasks}\underline{\textbf{\tasksTXT}}}
\newcommand{\aimtasks}{\pdfbookmark[1]{Цели и задачи}{aimtasks}\aimtasksTXT}
\newcommand{\novelty}{\pdfbookmark[1]{Научная новизна}{novelty}\underline{\textbf{\noveltyTXT}}}
\newcommand{\influence}{\pdfbookmark[1]{Практическая значимость}{influence}\underline{\textbf{\influenceTXT}}}
\newcommand{\methods}{\pdfbookmark[1]{Методология и методы исследования}{methods}\underline{\textbf{\methodsTXT}}}
\newcommand{\defpositions}{\pdfbookmark[1]{Положения, выносимые на защиту}{defpositions}\underline{\textbf{\defpositionsTXT}}}
\newcommand{\reliability}{\pdfbookmark[1]{Достоверность}{reliability}\underline{\textbf{\reliabilityTXT}}}
\newcommand{\probation}{\pdfbookmark[1]{Апробация}{probation}\underline{\textbf{\probationTXT}}}
\newcommand{\contribution}{\pdfbookmark[1]{Личный вклад}{contribution}\underline{\textbf{\contributionTXT}}}
\newcommand{\publications}{\pdfbookmark[1]{Публикации}{publications}\underline{\textbf{\publicationsTXT}}}

\input{common/characteristic} % Характеристика работы по структуре во введении и в автореферате не отличается (ГОСТ Р 7.0.11, пункты 5.3.1 и 9.2.1), потому её загружаем из одного и того же внешнего файла, предварительно задав форму выделения некоторым параметрам

Диссертационная работа была выполнена при поддержке гранта РФФИ № 20-31-90109.

%\underline{\textbf{Объем и структура работы.}} Диссертация состоит из~введения,
%четырех глав, заключения и~приложения. Полный объем диссертации
%\textbf{ХХХ}~страниц текста с~\textbf{ХХ}~рисунками и~5~таблицами. Список
%литературы содержит \textbf{ХХX}~наименование.

\pdfbookmark{Содержание работы}{description}                          % Закладка pdf
\section*{Содержание работы}
Во \underline{\textbf{введении}} обосновывается актуальность
исследований, проводимых в~рамках данной диссертационной работы,
%приводится обзор научной литературы по~изучаемой проблеме,
формулируется цель, ставятся задачи работы, излагается научная новизна
и практическая значимость представляемой работы.

%В~последующих главах сначала описывается общий принцип, позволяющий \dots, а~потом идёт апробация на частных примерах: \dots  и~\dots.

\underline{\textbf{Первая глава}} посвящена математической формулировки задачи моделирования общей циркуляции океана и особенностям численной реализации сигма-модели общей циркуляции океана INMOM.

В \underline{\textit{разделе 1.1}} представлена математическая формулировка задачи моделирования общей циркуляции океана, основанной на системе уравнений гидротермодинамики в приближениях гидростатики и Буссинеска для сферического слоя на Земле в предположении ее постоянного радиуса.
В разделе представлено описание перехода системы уравнений гидротермодинамики океана в новую систему координат с использованием вертикальной координаты $\sigma$, используемой в модели общей циркуляции океана INMOM.
Сигма координата зависит от горизонтальных координат, отклонения уровня и глубины океана, и в главе представлен подробный анализ трудностей и особенностей применения сигма-моделей океана, включая погрешности в аппроксимации горизонтального градиента давления. Описаны методы снижения этих погрешностей, учитывая особенности разностной аппроксимации градиентов давления.
%Подробное описание численной реализации модели включает в себя специфику пространственной аппроксимации на 'C'-сетке и методику построения согласованных операторов разностной аппроксимации. Описанная схема по времени позволяет эффективно решать систему уравнений гидротермодинамики океана на каждом шаге интегрирования.
Данный раздел также включает описание подготовки к решению системы уравнений гидротермодинамики океана, включая приведение к дивергентному виду и симметризацию градиента давления. 

В \underline{\textit{разделе 1.2}} представлено подробное описание численной реализации модели, включая специфику пространственной аппроксимации на 'C'-сетке по классификации Аракавы и методику построения согласованных операторов разностной аппроксимации.
В разделе описывается двухслойная схема по времени, которая используется для интегрирования модели. Процесс интегрирования включает линеаризацию нелинейных слагаемых, что позволяет рассчитывать переменные на новом временном шаге, исходя из значений на предыдущем шаге.
Описанная схема по времени позволяет эффективно решать систему уравнений гидротермодинамики океана на каждом шаге интегрирования.
%Представляет пространственно аппроксимации модели, которая базируется на 'C'-сетке по классификации Аракавы. Эта сетка является нерегулярной по долготе и широте, а также неравномерной по вертикали. Для численного решения системы уравнений гидротермодинамики океана применяется разностная аппроксимация второго порядка точности. Особое внимание уделяется сохранению свойств симметрии разностных аналогов операторов, соблюдая их энергетические соотношения.
%Кроме того, описывается двухслойная схема по времени, которая используется для интегрирования модели. Процесс интегрирования включает линеаризацию нелинейных слагаемых, что позволяет рассчитывать переменные на новом временном шаге, исходя из значений на предыдущем шаге.

В \underline{\textit{разделе 1.3}} описывается общая схема численного решения системы уравнений гидротермодинамики океана с использованием метода расщепления Г.И. Марчука. Метод основан на физическом расщеплении процессов и включает инициализацию, основной цикл по времени и финализацию.
%Основной цикл включает определение текущего модельного времени, задание потоков на поверхности и открытых границах, расчет компонентов напряжений, коэффициентов турбулентного обмена, углов наклона для универсальной диффузии, расчет потоков на поверхности и дне, а также обновление толщины океана и вертикальной скорости в соответствии с уравнением неразрывности.
%Также осуществляется расчет коэффициентов вертикального обмена с использованием различных параметризаций, анализ температуры и солености с учетом различных схем переноса, диффузии для компонентов скорости, а также расчет плотности по обновленным значениям температуры и солености.
%Процедуры бароклинной и баротропной адаптации способствуют эффективной стабилизации расчетов по скорости внутренних волн и внешних гравитационных волн соответственно.
%Глава завершается описанием инструмента для решения систем линейных алгебраических уравнений, используемого для решения системы уравнений мелкой воды. Предложенный алгоритм успешно применяется для динамических расчетов океана и повторяется до достижения заданного расчетного времени."

\underline{\textit{Раздел 1.4}} описывает систему оперативного моделирования Северного Ледовитого океана и прилегающим к нему акваторий (INMOM-Арктика) построенную на основе усовершенствованной сигма-модели общей циркуляции океана INMOM.
Результаты сравнения расчетов и данных наблюдений свидетельствуют, что модель INMOM-Арктика с использованием предложенных условий на открытых границах позволяет корректно воспроизводить циркуляцию Северного Ледовитого океана.

В завершении, в \underline{\textit{разделе 1.5}} приводятся результаты анализа данных численного моделирования циркуляции Черного моря в период шторма, их физическая интерпретация, а также исследование аналитического решения описывающей их системы уравнений.

\underline{\textbf{Вторая глава}} посвящена математической постановке задачи модели мелкой воды как составной части модели гидродинамики океана и численной реализации решения системы уравнений мелкой воды, представленной в работе в виде отдельного программного комплекса.

В \underline{\textit{разделе 2.1}} рассматривается математическая постановка системы нелинейных уравнений мелкой воды в произвольной ортогональной системе координат, которая возникает при разрешении быстрых баротропных гравитационных волн в сигма-модели общей циркуляции океана INMOM.

\underline{\textit{Раздел 2.2}} посвящен описанию численной реализации модели мелкой воды, включая специфику использования методов дискретизации по пространству на 'C'-сетке по классификации Аракавы и специфику использования численной схемы 'Чехарда со средней точкой' для дискретизации по времени.

В \underline{\textit{разделе 2.3}} представлены результаты использования модели мелкой воды для моделирования цунами 2011 года в Японии и экстремального шторма на Азовском море в 2013 году. Важной частью исследования было сравнение результатов моделирования с экспериментальными данными и анализ различий в расчетах по нелинейным и линеаризованным уравнениям мелкой воды. Линеаризованные уравнения являются упрощением нелинейной системы, где используется предположение $h \approx H$ при условии $\zeta << H$.
Анализ указывает на хорошее соответствие результатов моделирования с данными наблюдений, и также было показано, что вклад нелинейности в контексте данных экстремальных событий незначителен.

\underline{\textbf{Третья глава}} посвящена описанию разработанных параллельных алгоритмов и особенностям параллельной реализации в модели мелкой воды и сигма-модели общей циркуляции океана INMOM.

\underline{\textit{Раздел 3.1}} представляет подробный анализ разработанной программной архитектуры модели мелкой воды и методов параллельных вычислений для эффективного использования модели на различных вычислительных системах.
Программная архитектура является ключевым элементом, определяющим гибкость, масштабируемость и переносимость модели на различные типы вычислительных систем. Представленная в работе архитектура базируется на принципе разделения обязанностей, что позволяет выделить три уровня программного комплекса: Ядро (содержит все вычислительные подпрограммы модели), Алгоритм (описывает основной временной цикл модели) и Интерфейс (реализует все параллельные методы и подходы в модели).
Этот подход значительно упрощает интеграцию новых компонентов и алгоритмов, а также облегчает адаптацию кода под различные вычислительные системы без изменений в основных вычислительных процедурах.

В \underline{\textit{разделе 3.2}} представлен усовершенствованный двумерный метод декомпозиции области, так называемый блочный подход, используемый в модели в качестве основного метода распараллеливания для вычислительных архитектур с распределенной памятью.
Рассматриваемый блочный подход позволяет формировать подобласти произвольной формы, обеспечивая балансировку нагрузки вычислений на процессоры, и эффективно использовать кэш-память.

В \underline{\textit{разделе 3.3}} описан метод балансировки нагрузки вычислений на процессоры с использованием фрактальной кривой Гильберта в двумерном пространстве.
Методы балансировки нагрузки вычислений позволяют снизить время простоя отдельных процессоров и тем самым повысить эффективность параллельной программы, что существенно важно при решении задач на высокопроизводительных вычислительных системах.
В данной главе показано, что предложенный метод балансировки нагрузки показывает хорошие результаты применительно к решению уравнений мелкой воды, а также показано сравнение этого метода с методом балансировки нагрузки, основанном на графах из библиотеки METIS.

В \underline{\textit{разделе 3.4}} и \underline{\textit{разделе 3.5}} представлены различные модели параллельного программирования для использования на многопроцессорных и гетерогенных вычислительных системах (см. рис. \ref{fig:patterns}):

\begin{enumerate}

\item Чистый MPI подход для использования на вычислительных архитектурах с распределенной памятью.
\item Гибридный MPI-OpenMP подход для использования на многопроцессорных систем с общей памя­тью.
\item Гибридный синхронный MPI-OpenMP-CUDA подход для использования на гетерогенных вычислительных системах.
\item Гибридный MPI-OpenMP-CUDA подход для использования на гетерогенных вычислительных системах с несколькими GPU на вычислительном узле.
\item Гибридный асинхронный MPI-CUDA подход для использования на гетерогенных вычислительных системах с перекрытием передачи данных и выполнения по времени.

\end{enumerate}

\begin{figure}[!ht]
	\includegraphics[width=\linewidth]{CPU_GPU_patterns.png}
	\vspace{3pt}
	\caption{Параллельные шаблоны программирования реализованные в модели}
	\label{fig:patterns}
\end{figure}

%5Можно сослаться на свои работы в автореферате. Для этого в файле \verb!Synopsis/setup.tex! необходимо присвоить положительное значение счётчику \verb!\setcounter{usefootcite}{1}!. В таком случае ссылки на работы других авторов будут подстрочными. Изложенные в третьей главе результаты опубликованы в~\cite{vakbib1, vakbib2}. Использование подстрочных ссылок внутри таблиц может вызывать проблемы.

В \underline{\textit{разделе 3.6}} приводится описание реализации усовершенствованной параллельной версии сигма-модели общей циркуляции океана INMOM, основанной на разработанных параллельных вычислительных алгоритмах решения нелинейных уравнений мелкой воды.
В сигма-модели океана INMOM были поддержаны гибридные модели параллельного программирования для использования на многопроцессорных вычислительных системах, подробно описанные в разделе 3.4.
Описаны усовершенствованный двумерный метод декомпозиции области (блочный подход) и особенности синхронизации внерасчетных границ применительно к трехмерной задаче.
В разделе описан метод баланси­ровки нагрузки вычислений с использованием кривых Гильберта применительно к трехмерным уравнением гидротермодинамики океана, используемых в модели INMOM.
Важно отметить, что оптимальность разбиения для мелкой воды точно соответствует оптимальности для трехмерной сигма-модели INMOM, так как количество расчетных уровней по глубине в модели одинаково для всех точек сетки по горизонтали.
Были также описаны детали реализации решателя системы алгебраических уравнений, возникающих в модели океана на этапе баратропной адаптации.

В \underline{\textbf{четвертой главе}} приведены результаты исследования производительности и масштабируемости моделей мелкой воды и общей циркуляции океана INMOM на современных суперкомпьюетрах.

В \underline{\textit{разделе 4.1}} приведены результаты исследования масштабируемости модели мелкой воды, проведенные на суперкомпьютере Ломоносов-2 в Мос­ковском государственном университете имени Ломоносова.
%Первая серия вычислительных экспериментов проводилась для акватории без участков суши. Эта серия экспериментов проводилась с целью продемон­стрировать производительность модели без эффектов неравномерной нагрузки на процессоры.
В разделе был проведён анализ эффективности и масштабируемости гибридных методов для расчётов мелкой воды с использованием GPU в сравнении с методами расчётов на CPU (см. рис \ref{fig:TheBox}). 
Продемонстрирована масштабируемость различных подходов на CPU и GPU для расчётных областей 1525 на 1115 и 6100 на 4460 точек: производительность на одну точку сетки на GPU резко снижается после $2^{19}$ точек на узел, в то время как производительность на CPU отлично масштабируется до $2^{17}$ точек (см. рис \ref{fig:TheBox_full}). Это связано с тем, что небольшой размер сетки не может в достаточной степени загрузить GPU и скрыть задержки при обращении к памяти. Кроме того, накладные расходы на передачу данных между CPU и GPU становятся значительными при небольших размерах сетки. Таким образом, получается снижение производительности GPU при небольших размерах сетки.  Тем не менее, вычисления на GPU превосходят вычисления на CPU в 4,7 раза на 30 узлах, использующих 360 ядер CPU и 60 GPU при размере сетки 6100 $\times$ 4460.  

\begin{figure}[!ht]
	\begin{minipage}{0.5\linewidth}
	\centering
	\includegraphics[width=\linewidth]{v3_3_6100x4460_pascal_speedup_multiGPU_V.png}
	\subcaption{Ускорение}
	\end{minipage}
	\begin{minipage}{0.5\linewidth}
	\centering
    \includegraphics[width=\linewidth]{v3_3_6100x4460_pascal_time_multiGPU_V.png}
	\subcaption{Время одного шага модели (в логарифмической шкале)}
	\end{minipage}
	\vspace{3pt}
	\caption{Масштабируемость методов для расчётов мелкой воды с использованием GPU в сравнении с методами расчётов на CPU}
	\label{fig:TheBox}
\end{figure}

Было также подремонтировано, что, за счёт перекрытия вычислений с передачей данных, асинхронный подход MPI-OpenMP-CUDA лучше масштабируется до 8 узлов и на 28\% производительнее на 8 графических процессорах, чем синхронный подход без перекрытия вычислений с передачей данных. Продемонстрировано преимущество использования метода балансировки нагрузки вычислений на примере расчёта акватории Азовского моря с разрешением в 250 метров. Было показано, что производительность расчётов с балансировкой нагрузки вычислений превосходят производительность расчётов без балансировки на 30\% на 16 узлах как при использовании CPU, так и при использовании GPU.

\begin{figure}[!ht]
	\begin{minipage}{1\linewidth}
	\centering
	\includegraphics[width=0.5\linewidth]{v3_3_pascal_analysic_fix_1.png}
	\end{minipage}
	\vspace{3pt}
	\caption{Производительность на одну точку сетки при вычислениях на CPU и GPU}
	\label{fig:TheBox_full}
\end{figure}

В разделе продемонстрирована эффективность блочного подхода, а именно что,
выбирая малые размеры блоков, компенсируются затраты на копирование границ блоков при синхронизации за счет эффективной работа с кэш памя­тью.

	\begin{figure}[htb!]
    \begin{minipage}[h]{0.48\linewidth}
    \center{\includegraphics[width=1.0\linewidth]{plot4_upd_global.png}}
    \end{minipage}
    \hfill
    \begin{minipage}[h]{0.48\linewidth}
    \center{\includegraphics[width=1.0\linewidth]{plot4_upd_tt_ss.png}}
    \end{minipage}
    \caption{Модель океана INMOM. Ускорение метода разбиения с использованием кривых Гильберта в сравнении с равномерным разбиением и с METIS. 1) Общее время работы модели. 2) Расчет температуры и солености. 
    Чёрная линия соответствует линейному ускорению.}
    \label{fig:inmom_hilbert1}
    \end{figure}
    
     \begin{figure}[htb!]
    \begin{minipage}[h]{0.48\linewidth}
    \center{\includegraphics[width=1.0\linewidth]{plot4_upd_uv_tran_diff.png}}
    \end{minipage}
    \hfill
    \begin{minipage}[h]{0.48\linewidth}
    \center{\includegraphics[width=1.0\linewidth]{plot4_upd_barotrop.png}}
    \end{minipage}
    \caption{Модель океана INMOM. Ускорение метода разбиения с использованием кривых Гильберта в сравнении с равномерным разбиением и с METIS. 1) Расчет переноса и диффузии для компонентов скорости. 2) Баротропная адаптация. 
    Чёрная линия соответствует линейному ускорению.}
    \label{fig:inmom_hilbert2}
    \end{figure}
    
В \underline{\textit{разделе 4.2}} приведены результаты исследования масштабируемости сигма-модели общей циркуляции океана INMOM.
В разделе приводятся результаты по тестированию метода нагрузки балансировки вычислений с использованием кривых Гильберта уже примени­тельно к полной трехмерной сигма-модели циркуляции океана INMOM. Тестирование модели проводилось на кластере ИВМ РАН для акватории Азовского моря.
Продемонстрировано, что методы балансировки нагрузки вычислений дают сверхлинейное ускорение для расче­тов температуры и солености и для расчета переноса и диффузии компонентов скорости, см рис. \ref{fig:inmom_hilbert1} и рис. \ref{fig:inmom_hilbert2}.
Это связано с тем, что при увеличении числа ядер, большая часть блоков, попадающих полностью на сушу, выпадает из рассмотрения. Более то­го, размер каждого блока становится мал и работа с кэш памятью становится наиболее эффективной.
Для общего расчетного времени модели метод балансировки нагрузки дает почти линейное ускорение и по сравнению с равномерным разбиением без балансировки нагрузки ускорение больше в $\sim 1.7$ раза, см. рис. \ref{fig:inmom_hilbert1}.

\FloatBarrier
\pdfbookmark{Заключение}{conclusion}                                  % Закладка pdf
В \underline{\textbf{заключении диссертации}} приведены основные результаты работы, которые заключаются в следующем:
\input{common/concl}

\pdfbookmark{Литература}{bibliography}                                % Закладка pdf

%При использовании пакета \verb!biblatex! список публикаций автора по теме
%диссертации формируется в разделе <<\publications>>\ файла
%\verb!common/characteristic.tex!  при помощи команды \verb!\nocite!

\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=false}}{} % не рекомендуется применять пакет микротипографики к автоматически генерируемому списку литературы
\urlstyle{rm}                               % ссылки URL обычным шрифтом
\ifnumequal{\value{bibliosel}}{0}{% Встроенная реализация с загрузкой файла через движок bibtex8
    \renewcommand{\bibname}{\large \bibtitleauthor}
    \nocite{*}
    \insertbiblioauthor           % Подключаем Bib-базы
    %\insertbiblioexternal   % !!! bibtex не умеет работать с несколькими библиографиями !!!
}{% Реализация пакетом biblatex через движок biber
    % Цитирования.
    %  * Порядок перечисления определяет порядок в библиографии (только внутри подраздела, если `\insertbiblioauthorgrouped`).
    %  * Если не соблюдать порядок "как для \printbibliography", нумерация в `\insertbiblioauthor` будет кривой.
    %  * Если цитировать каждый источник отдельной командой --- найти некоторые ошибки будет проще.
    %
    %% authorvak
    \nocite{vakbib1}%
    \nocite{vakbib2}%
    %
    %% authorwos
    \nocite{wosbib1}%
    %
    %% authorscopus
    \nocite{scbib1}%
    %
    %% authorpathent
    \nocite{patbib1}%
    %
    %% authorprogram
    \nocite{progbib1}%
    %
    %% authorconf
    \nocite{confbib1}%
    \nocite{confbib2}%
    %
    %% authorother
    \nocite{bib1}%
    \nocite{bib2}%

    \ifnumgreater{\value{usefootcite}}{0}{
        \begin{refcontext}[labelprefix={}]
            \ifnum \value{bibgrouped}>0
                \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
            \else
                \insertbiblioauthor      % Вывод всех работ автора
            \fi
        \end{refcontext}
    }{
        \ifnum \totvalue{citeexternal}>0
            \begin{refcontext}[labelprefix=A]
                \ifnum \value{bibgrouped}>0
                    \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
                \else
                    \insertbiblioauthor      % Вывод всех работ автора
                \fi
            \end{refcontext}
        \else
            \ifnum \value{bibgrouped}>0
                \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
            \else
                \insertbiblioauthor      % Вывод всех работ автора
            \fi
        \fi
        %  \insertbiblioauthorimportant  % Вывод наиболее значимых работ автора (определяется в файле characteristic во второй section)
        \begin{refcontext}[labelprefix={}]
            \insertbiblioexternal            % Вывод списка литературы, на которую ссылались в тексте автореферата
        \end{refcontext}
        % Невидимый библиографический список для подсчёта количества внешних публикаций
        % Используется, чтобы убрать приставку "А" у работ автора, если в автореферате нет
        % цитирований внешних источников.
        \printbibliography[heading=nobibheading, section=0, env=countexternal, keyword=biblioexternal, resetnumbers=true]%
    }
}
\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=true}}{}
\urlstyle{tt}                               % возвращаем установки шрифта ссылок URL
